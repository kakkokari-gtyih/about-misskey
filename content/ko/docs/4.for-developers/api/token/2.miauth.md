---
description: v12.27.0 이상에서 사용할 수 있는 Misskey만의 간단한 인증 방법을 설명합니다.
---

# MiAuth 방식의 액세스 토큰 획득 방식

애플리케이션을 이용하는 사용자(이하 단순히 '사용자'라 칭함)의 액세스 토큰을 발급받으려면 아래 절차에 따라 발급을 요청합니다.

:::tip

아래 설명할 방법은 앱을 만들지 않고 즉시 액세스 토큰을 발급하는 MiAuth라는 방법입니다.

- [더 많이 사용되는 OAuth 방식으로 액세스 토큰을 획득하는 방법도 있습니다.](./oauth.md)
- [앱 생성 방식으로 액세스 토큰을 획득하는 방법도 있습니다(구식).](./app.md)
  :::

:::

## Step 1

UUIDを生成する。以後これを**セッションID**と呼びます。

:::danger

このセッションIDは毎回生成し、使いまわさないようにしてください。

:::

## Step 2

アプリケーション認証フォームをユーザーのブラウザで表示させる。認証フォームは、以下の形式のURLで開くことができます:

```
https://{host}/miauth/{session}
```

ここで、

- `{host}`の部分は、ユーザーのサーバーのホストに置き換えます。通常ホストはユーザーが入力します。
- `{session}`の部分は、セッションIDに置き換えます。

また、URLにクエリパラメータとしていくつかのオプションを設定できます:

| 名前           | 説明                                                                             |
| ------------ | ------------------------------------------------------------------------------ |
| `name`       | アプリケーション名。                                                                     |
| `icon`       | アプリケーションのアイコン画像URL。                                                            |
| `callback`   | 認証が終わった後にリダイレクトするURL。<br>リダイレクト時には、`session`というクエリパラメータでセッションIDが付きます。          |
| `permission` | アプリケーションが要求する権限。<br>要求する権限を`,`で区切って列挙します。権限の一覧は[こちら](../permission.md)で確認できます。 |

:::tip{label='例'}

```
https://misskey.io/miauth/c1f6d42b-468b-4fd2-8274-e58abdedef6f?name=MyApp&callback=https%3A%2F%2Fmyapp.example.com%2Fcallback&permission=write:notes,write:following,read:drive
```

:::

## Step 3

ユーザーがアプリケーションアクセスを許可した後、次の形式のURLにPOSTリクエストすると、レスポンスとしてアクセストークンを含むJSONが返ります。

```
https://{host}/api/miauth/{session}/check
```

ここで、

- `{host}`の部分は、ユーザーのサーバーのホストに置き換えます。
- `{session}`の部分は、セッションIDに置き換えます。

レスポンスに含まれるプロパティは以下の通りです:

| 名前      | 説明             |
| ------- | -------------- |
| `token` | ユーザーのアクセストークン。 |
| `user`  | ユーザーの情報。       |
